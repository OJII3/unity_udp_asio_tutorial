# Chapter 4 - UDP通信してみよう

この章では、実際に UDP 通信を CLI のみで簡単に行なってみます。

## nc コマンド

UDP 通信を行うためには、`nc` コマンドを使用します。`nc` コマンドは、TCP 通信だけでなく UDP 通信も行うことができます。

## インストール

`nc` コマンドは、`netcat` という名前で提供されています。インストールされていない場合は、以下のコマンドでインストールしてください。

```bash
# Ubuntu
sudo apt install netcat
```

## 使い方(ホストが同一)


ターミナルを 2 つ開いて、それぞれ以下のコマンドを実行します。


```bash
# サーバー側
nc -ul 8080
```

```bash
# クライアント側
nc -u localhost 8080
```

クライアント側のターミナルに何か入力すると、サーバー側のターミナルに入力内容が表示されます。

### 解説

- `-u`オプション: プロトコルを UDP に設定します。
- `-l`オプション: リスニングモードに設定します。
- `localhost`: 自分自身を指します。IPアドレス `127.0.0.1` とほぼ同じ意味です。

## 使い方(ホストが異なる)

Linux PC を 2 台用意して、同一のルーターに接続します。

サーバー側にする PC のIP アドレスを取得するため、以下のコマンドを実行します。

```bash
ip a
```

`enp0s3` などのインターフェース名の横に `inet` と書かれている行があります。その行に書かれている IP アドレスがサーバー側の IP アドレスです。`192.168` で始まるアドレスが割り当てらていることが多いです。


```bash
# サーバー側
nc -ul 8080
```

```bash
# クライアント側
nc -u <サーバー側のIPアドレス> 8080
```

クライアント側のターミナルに何か入力すると、サーバー側のターミナルに入力内容が表示されます。

もし上手く通信できない場合は、ファイアウォールの設定を確認してください。ファイアウォールが有効になっている場合、UDP 8080 ポートを開放してください。`ufw` を使用している場合は、以下のコマンドでポートを開放できます。

```bash
sudo ufw allow 8080/udp
```

## まとめ

`nc` コマンドを使用することで、簡単に UDP 通信を行うことができます。ネットワークの基本を理解するために、是非試してみてください。

次の章では、Wireshark を使用して UDP 通信を観察してみます。
