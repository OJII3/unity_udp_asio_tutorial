# Chapter 3 - ネットワークの基礎知識

この章では、UDP 通信の基本を学びます。小難しい話が多いので、曖昧な理解なまま次へ進んでも大丈夫です。

## OSI 参照モデル

詳しくは触れませんが、OSI 参照モデルの考え方はプロトコルを考える上で非常に重要です。ネットワークの学習の基本ですので、気になる方は調べてみてください。


| 階層 | 名前 | 機能 | プロトコルの例 |
| --- | --- | --- | --- |
| 7 | アプリケーション | ユーザーが直接利用するソフトウェア | HTTP, FTP, SMTP |
| 6 | プレゼンテーション | データの表現形式を変換 | JPEG, MPEG |
| 5 | セッション | 通信の開始・終了を管理 | NetBIOS |
| **4** | **トランスポート** | データの転送を管理 | TCP, **UDP** |
| 3 | ネットワーク | ルーティングを管理 | IP, ICMP |
| 2 | データリンク | フレームの管理 | Ethernet |
| 1 | 物理 | ビットの転送 | Ethernet |

OSI 参照モデルの第 4 層であるトランスポート層で使用される通信プロトコルの 1 つが UDP (User Datagram Protocol) です。UDP は、IP ネットワーク上でデータを送受信するためのプロトコルです。


## IPアドレスとポート番号

まず、ネットワークを用いて通信を行うためには、送信元と宛先のアドレスが必要です。IP アドレスはネットワーク上での住所のようなもので、通信を行う相手を特定するために使用されます。また、ポート番号は、アプリケーションを特定するために使用されます。IP アドレスとポート番号を組み合わせて通信を行います。`127.0.0.1:8080` のように、
`<IP アドレス>:<ポート番号>` で表現されることが一般的です。

## IP アドレス

ここでは IPv4 に限定して説明します。IPv4 は 32 ビットのアドレス空間を持ち、8 ビットずつ 4 つに分けて表現されます。また、IP アドレスはネットワーク部とホスト部に分かれています。ネットワーク部はネットワークを特定するために使用され、ホスト部はネットワーク内のホストを特定するために使用されます。

### ローカルネットワーク(LAN)

上述の通り、IP アドレスはネットワーク部とホスト部に分かれています。ローカルネットワーク内で通信を行う場合、ネットワーク部は同じでホスト部が異なる IP アドレスを使用します。例えば、市販のルーターを使用している場合、ルーターが自動的に IP アドレスを割り当てます。このような IP アドレスをプライベート IP アドレスと呼びます。プライベート IP アドレスは、以下の範囲に割り当てられます。

- 10.0.0.0 〜 10.255.255.255
- 172.16.0.0 〜 172.31.255.255
- 192.168.0.0 〜 192.168.255.255

これらの範囲に含まれる IP アドレスは、インターネット上では使用されず、ローカルネットワーク内でのみ使用されます。これにより、同じプライベート IP アドレスが異なるローカルネットワークで使用されることが可能になります。

### グローバル IP アドレス

一方、グローバル IP アドレスはインターネット上で一意に特定されるアドレスです。インターネットサービスプロバイダー (ISP) から提供され、インターネット上の通信に使用されます。グローバル IP アドレスは、プライベート IP アドレスとは異なり、全世界で一意である必要があります。

### NAT (Network Address Translation)

ローカルネットワーク内のデバイスがインターネットにアクセスする際には、NAT (Network Address Translation) が使用されます。NAT は、ローカルネットワーク内のプライベート IP アドレスをグローバル IP アドレスに変換する技術です。これにより、複数のデバイスが同じグローバル IP アドレスを共有してインターネットにアクセスすることができます。

## UDP の特徴

UDP は、TCP (Transmission Control Protocol) と比較して以下のような特徴があります。

- コネクションレス: UDP はコネクションを確立せずにデータを送信します。これにより、接続の確立や切断のオーバーヘッドがなくなります。
- 信頼性の欠如: UDP はデータの到達確認や再送制御を行わないため、データが失われる可能性があります。しかし、これにより高速な通信が可能になります。
- 軽量: UDP ヘッダーは 8 バイトと非常に小さく、オーバーヘッドが少ないです。

これらの特徴から、UDP はリアルタイム性が求められるアプリケーション (例: オンラインゲーム、VoIP) や、信頼性よりも速度が重視される用途に適しています。

## まとめ

- UDP は IP ネットワーク上でデータを送受信するためのプロトコルです。
- IP アドレスとポート番号を組み合わせて通信を行います。
- UDP はコネクションレスであり、信頼性の欠如と軽量さが特徴です。

次の章では、実際に UDP 通信を CLI のみで簡単に行なってみます。
