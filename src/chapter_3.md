# Chapter 3 - UDP通信

この章では、Unity や ROS 2 等は用いずに、UDP 通信の基本を学びます。すでに知識がある場合は、次の章に進んでください。

## OSI参照モデル

UDP 通信を理解するためには、まず OSI 参照モデルについて理解する必要があります。また、この階層化の考え方は、今後通信プロトコルを作成する際にも役立ちます。

ISO により定義された OSI 参照モデルは、通信プロトコルの標準化を目的としています。このモデルは、7つの階層に分かれており、それぞれが通信の一部を担当しています。

| 階層 | 名前 | 機能 | プロトコルの例 |
| --- | --- | --- | --- |
| 7 | アプリケーション | ユーザーが直接利用するソフトウェア | HTTP, FTP, SMTP |
| 6 | プレゼンテーション | データの表現形式を変換 | JPEG, MPEG |
| 5 | セッション | 通信の開始・終了を管理 | NetBIOS |
| 4 | トランスポート | データの転送を管理 | TCP, UDP |
| 3 | ネットワーク | ルーティングを管理 | IP, ICMP |
| 2 | データリンク | フレームの管理 | Ethernet |
| 1 | 物理 | ビットの転送 | Ethernet |

これは非常に簡易的な説明であり、全て覚える必要はありません。

通信プロトコルというのは雑に、「0と1からなるデータのどこからどこまでが何を意味しているのか」を示す規格と言えます。例えば、UDP の場合、先頭から 8 バイト目までがヘッダー部であり、その後ろがデータ部となります。ヘッダーには、送信元のポート番号や宛先のポート番号、データの長さ等が含まれています。(ポートが何かは後述します)

そして、このモデルは上位の階層が下位の階層を利用する形で通信が行われます。例えば、アプリケーション層で HTTP 通信を行う場合、HTTP は TCP を利用してデータを転送します。TCP は IP を利用してデータを転送します。IP は Ethernet を利用してデータを転送します。言い換えれば、Ethernet のデータ部にはIPのヘッダーとデータが含まれており、そのIPのデータ部にはTCPのヘッダー部とデータ部が......というわけです。 このとき、各階層は下位の階層のことを意識する必要が無いように設計されており、そのように実装されています。

## IPアドレスとポート番号

通信を行うためには、送信元と宛先のアドレスが必要です。IP アドレスは、インターネット上での住所のようなもので、通信を行う相手を特定するために使用されます。IPv4 では

